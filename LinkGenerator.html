<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
  <title>Link Generator</title>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</head>

<body class="p-3 m-0 border-0 bd-example m-0 border-0">

  <h1 style="text-align: center;">Link Generator</h1>
  <h5 style="text-align: center;">The tool to help you generate the add-in link. Please try out!</h5>
  <br>
  <div class="container text-left">
    <div class="row">
      <div class="col">
        <div class="input-group">
          <span class="input-group-text" id="inputGroup-addin-id"><strong>Add-in ID</strong></span>
          <input id="input-addin-id" type="text" class="form-control" aria-label="Sizing example input"
            aria-describedby="inputGroup-sizing-default">
        </div>
      </div>
      <div class="col">
        <small style="font-style: italic;">
          This is the unique add-in ID. It is case sensitive. Please use upper case in order to succeed. You can get the correct value by following below steps.
          <br>
          1. Go to 
          <a href="https://appsource.microsoft.com/en-US/" target="_blank"
            rel="noopener noreferrer nofollow">https://appsource.microsoft.com/en-US/</a>
          from your browser.
          <br>
          2. Input your Office add-in name in the search bar on top center of AppSource homepage and get results.
          <br>
          3. Click your add-in in the search results and then add-in information page will be automatically displayed in current tab.
          <br>
          4. The add-in ID is in the URL, between "product/office/" and "?tab=Overview".
          <br>
          For example, if the add-in information page is
          <a href="https://appsource.microsoft.com/en-US/product/office/WA104380862?tab=Overview" target="_blank"
            rel="noopener noreferrer nofollow">https://appsource.microsoft.com/en-US/product/office/WA104380862?tab=Overview</a>
          , then the add-in ID is "WA104380862".
        </small>
      </div>
    </div>
    <br>
    <div class="row">
      <div class="col">
        <div class="input-group mb-3">
          <span class="input-group-text" id="inputGroup-addin-name"><strong>Add-in name</strong></span>
          <input id="input-addin-name" type="text" class="form-control" aria-label="Sizing example input"
            aria-describedby="inputGroup-sizing-default">
        </div>
      </div>
      <div class="col">
        <small style="font-style: italic;">
          This is the exact add-in name in AppSource. You can get the correct value by following below steps.
          <br>
          1. Go to
          <a href="https://appsource.microsoft.com/en-US/" target="_blank"
            rel="noopener noreferrer nofollow">https://appsource.microsoft.com/en-US/</a>
          from your browser.
          <br>
          2. Input your add-in ID in the search box on top center of AppSource homepage and get results.
          <br>
          3. Copy the add-in name which is below your add-in icon, and paste it here without any change.
          <br>
          For example, if the search result page is
          <a href="https://appsource.microsoft.com/en-US/marketplace/apps?search=WA104380862&page=1" target="_blank"
            rel="noopener noreferrer nofollow">https://appsource.microsoft.com/en-US/marketplace/apps?search=WA104380862&page=1</a>
          , then the add-in name is "Script Lab, a Microsoft Garage project".
        </small>
      </div>
    </div>
  </div>
  <div class="container text-left">
    <div class="row">
      <div class="col">
        <div><strong>Supported products</strong></div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckWordDesktop">
          <label class="form-check-label" for="flexCheckDefault">
            Word
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckExcelDesktop">
          <label class="form-check-label" for="flexCheckDefault">
            Excel
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckPowerPointDesktop">
          <label class="form-check-label" for="flexCheckDefault">
            PowerPoint
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckWord">
          <label class="form-check-label" for="flexCheckDefault">
            Word on the Web
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckExcel">
          <label class="form-check-label" for="flexCheckDefault">
            Excel on the Web
          </label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" value="" id="flexCheckPowerPoint">
          <label class="form-check-label" for="flexCheckDefault">
            PowerPoint on the Web
          </label>
        </div>
      </div>
    </div>
  </div>
  <br>
  <div class="container text-left">
    <div class="row">
      <div class="col">
        <div class="input-group">
          <span class="input-group-text" id="inputGroup-language"><strong>Language</strong></span>
          <input id="input-language" type="text" placeholder="en-US" class="form-control" aria-label="Sizing example input"
            aria-describedby="inputGroup-sizing-default">
        </div>
      </div>
      <div class="col">
        <small style="font-style: italic;">
          This is the language of Add-in instructions after opened on Word/Excel/PowerPoint on Windows or Mac. 
          <br>
          The default value is "en-US". Please set to other language if needed. For example: "de-DE", "fr-FR", "it-IT", "ja-JP", "zh-CN".
          <br>
          Please leave this blank if your Add-in is only available on Office on the Web.
        </small>
    </div>
  </div>

  <br>

  <div class="container text-left">
    <div class="row">
      <div class="col">
        <button id="get-url" type="button" class="btn btn-primary" onclick="getUrl()">Get the Link</button>
        <hr>
        <h6>The links generated for your add-in:</h6>
        <p id="links"></p>

      </div>
    </div>
  </div>

  <script>
    function generateGUID() {
            var d = new Date().getTime();
            if (
                typeof performance !== 'undefined' &&
                typeof performance.now === 'function'
            ) {
                d += performance.now(); //use high-precision timer if available
            }
            return 'xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx'.replace(
                /[xy]/g,
                function (c) {
                    var r = (d + Math.random() * 16) % 16 | 0;
                    d = Math.floor(d / 16);
                    return (c === 'x' ? r : (r & 0x3) | 0x8).toString(16);
                }
            );
        }

    function getUrl() {
      var addinId = document.getElementById("input-addin-id").value;
      var addinName = document.getElementById("input-addin-name").value;      
      var language = document.getElementById("input-language").value;
      var languageDefault = "en-US";

      if (addinId == "") {
        alert("Please input the add-in ID!");
        return;
      }

      if (addinName == "") {
        alert("Please input the add-in name!");
        return;
      }

      if (document.getElementById("flexCheckPowerPointDesktop").checked == false && 
          document.getElementById("flexCheckExcelDesktop").checked == false && 
          document.getElementById("flexCheckWordDesktop").checked == false && 
          document.getElementById("flexCheckWord").checked == false && 
          document.getElementById("flexCheckExcel").checked == false && 
          document.getElementById("flexCheckPowerPoint").checked == false) {
        alert("Please select the supported products!");
        return;
      }

      document.getElementById("links").innerHTML = "";

      if (document.getElementById("flexCheckWordDesktop").checked) {
        var correlation = generateGUID();
        var language = language == "" ? languageDefault : language;
        var linkWordDesktop = 'ms-word:https://api.addins.store.office.com/addinstemplate/'.concat(
                            language,
                            '/',
                            correlation,
                            '/',
                            addinId,
                            '/none/',
                            addinName.replace(/[^A-Za-z0-9]/g, '-'),
                            '.docx?omexsrctype=1');

        document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
          '<p>Word: ',
          '<a href="', linkWordDesktop, '" target="_blank" rel="noopener noreferrer">',
            linkWordDesktop,
          '</a>',
          '<strong> Note: ',
            correlation,
          ' is the correlation for diagnostic purpose. We strongly recommend you to runtime generate it and make it different per click. Please look at generateGUID() function as an example of how to generate it.</strong>',
          '</p>'
        );
      }

      if (document.getElementById("flexCheckExcelDesktop").checked) {
        var correlation = generateGUID();
        var language = language == "" ? languageDefault : language;
        var linkExcelDesktop = 'ms-excel:https://api.addins.store.office.com/addinstemplate/'.concat(
                            language,
                            '/',
                            correlation,
                            '/',
                            addinId,
                            '/none/',
                            addinName.replace(/[^A-Za-z0-9]/g, '-'),
                            '.xlsx?omexsrctype=1');

        document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
          '<p>Excel: ',
          '<a href="', linkExcelDesktop, '" target="_blank" rel="noopener noreferrer">',
            linkExcelDesktop,
          '</a>',
          '<strong> Note: ',
            correlation,
          ' is the correlation for diagnostic purpose. We strongly recommend you to runtime generate it and make it different per click. Please look at generateGUID() function as an example of how to generate it.</strong>',
          '</p>'
        );
      }

      if (document.getElementById("flexCheckPowerPointDesktop").checked) {
        var correlation = generateGUID();
        var language = language == "" ? languageDefault : language;
        var linkPowerPointDesktop = 'ms-powerpoint:https://api.addins.store.office.com/addinstemplate/'.concat(
                            language,
                            '/',
                            correlation,
                            '/',
                            addinId,
                            '/none/',
                            addinName.replace(/[^A-Za-z0-9]/g, '-'),
                            '.pptx?omexsrctype=1');

        document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
          '<p>PowerPoint: ',
          '<a href="', linkPowerPointDesktop, '" target="_blank" rel="noopener noreferrer">',
            linkPowerPointDesktop,
          '</a>',
          '<strong> Note: ',
            correlation,
          ' is the correlation for diagnostic purpose. We strongly recommend you to runtime generate it and make it different per click. Please look at generateGUID() function as an example of how to generate it.</strong>',
          '</p>'
        );
      }

      if (document.getElementById("flexCheckWord").checked) {
        var linkWord = 'https://go.microsoft.com/fwlink/?linkid=2261098&templateid='.concat(addinId,
          '&templatetitle=',
          addinName);

        document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
          '<p>Word on the web: ',
          '<a href="', linkWord, '" target="_blank" rel="noopener noreferrer">',
          linkWord,
          '</a>',
          '</p>'
        );
      }

      if (document.getElementById("flexCheckExcel").checked) {
        var linkExcel = 'https://go.microsoft.com/fwlink/?linkid=2261819&templateid='.concat(addinId,
          '&templatetitle=',
          addinName);

        document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
          '<p>Excel on the web: ',
          '<a href="', linkExcel, '" target="_blank" rel="noopener noreferrer">',
          linkExcel,
          '</a>',
          '</p>'
        );
      }

      if (document.getElementById("flexCheckPowerPoint").checked) {
        var linkPowerPoint = 'https://go.microsoft.com/fwlink/?linkid=2261820&templateid='.concat(addinId,
          '&templatetitle=',
          addinName);

        document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
          '<p>PowerPoint on the web: ',
          '<a href="', linkPowerPoint, '" target="_blank" rel="noopener noreferrer">',
          linkPowerPoint,
          '</a>',
          '</p>'
        );
      }

      document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
        '<h5>If you are interested in promoting your add-in on your website, please take a look at <a href="https://github.com/OfficeDev/OfficeJSAddinWidget/tree/main/WebWidget" target="_blank" rel="noopener noreferrer nofollow">Web Widget.</a></h5>'
      );

      document.getElementById("links").innerHTML = document.getElementById("links").innerHTML.concat(
        '<br><h6>Special Notice</h6>',
          '<p>The deeplink can successfully open an Office document with your add-in and the end users can use your add-in for below scenarios only.</p>',
          '<p>&emsp;1. The add-in is public published, so that it can be found from Office AppSource.</p>',
          '<p>&emsp;2. The Office store is enabled for the end user.</p>');

    }
  </script>

</body>

</html>
